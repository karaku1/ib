Лаб №1

Лаб №2




5.Права доступа к объектам
Смена прав доступа к объектам выполняется администратором команд>
sudo chmod 775 <имя объекта>
sudo chmod g-x <имя объекта>

Смена владельцев и группы владельцев вполняется администратором >
sudo chown <владелец: группа владельцев> <имя объекта>
sudo chgrp <Группа владельцев> <имя объекта>

Режим группового доустпа к объектам можно  использовать при смен>
newgrp <имя группы>

Специальные права доступа к объектам: SUID, GUID , stickly bit

Специальный бит SUID  преднахначен для запуска файла от имени его владельца. Эта процелура позволяет обычным пользователям получить права на доступ к объектам, которыми может распоряжаться владелец файла.
Пример - программа /bin/passwd, для функционирования которой нужны права записи в файл /etc/shadow 
Такие права есть только  у пользователей root , поэтому у программы /bin/passwd  владелец root и установлен бит SUID
В результате любой пользователь может сменить свой пароль, не обращаясь к администратору

Установка бита SUID осуществляется при помощи программы chmod:
sudo chmod u+s <file name>
sudo chmod 4775 <file name>

Сброс бита SUID осуществляется аналогично:
sudo chmod u-s <file name>
sudo chmod 0775  <file name>

Бит SUID нет смысла применять к папкам.

Специальный бит GUID  предназачен для запуска файла от имени группы владельцев, либо для изменения правил наследования группы владельцев , если он установлен для папки 

Установка  бита GUID осуществляется chmod:
sudo chmod u-s <file name>
sudo chmod 0775  <file name>
 
Права доступа к файлу с установленным Guid:
 - rwxrwsr-x1 student root


Права доступа к каталогу с уставленным GUID:
drwxrwsr-x 3 student root

При установке бита Guid на папку все объекты, созданные внутри папки, наследуют группу владельца от родителя.
При этом дочерние папки наследуют бит GUID

Пример: объекты в папке с установленным GUID:
-rw-rw-r-- 1 student root    0 окт 30 13:18 123
-rw-rw-r-- 1 student root    0 окт 30 13:18 234
drwxrwsr-x 2 student root 4096 окт 30 13:18 f123

GUID-бит применяется и для файлов, и для папок.

Sticky bit - устанавливается только на папки и определяет особые правила удаления объектов внутри папки.
Для папок с установленным Sticky bit запрещается операция удаления файлов даже для тех пользователей, кто имеет права на запись. Владельцы объектов и пользователи, входящие в группу владельцев папки имеет возможность удалить свои объекты без ограничений.

Устанавливается Sticky bit при помощи команды chmod:

sudo chmod o+t <имя папки>
sudo 1775 <имя папки>

Права доступа до установки спецбита:
student@alexander-VirtualBox:~$ stat 58008/
  Файл: 58008/
  Размер: 4096	Блоков: 8          Блок В/В: 4096   каталог
Устройство: 803h/2051d	Инода: 938801      Ссылки: 2
Доступ: (1777/drwxrwxrwt)  Uid: ( 1001/ student)   Gid: ( 1001/ student)

Пример установки бита:
student@alexander-VirtualBox:~$ sudo chmod o+t 58008/
student@alexander-VirtualBox:~$ stat 58008/
  Файл: 58008/
  Размер: 4096	Блоков: 8          Блок В/В: 4096   каталог
Устройство: 803h/2051d	Инода: 938801      Ссылки: 2
Доступ: (1777/drwxrwxrwt)  Uid: ( 1001/ student)   Gid: ( 1001/ student)
 

Права доступа к объектам внутри 58008:
tmp6@alexander-VirtualBox:/home/student/58008$ ls -l
итого 8
drwxrwxrwx 2 student student 4096 ноя  6 12:37 F
-rw-rw-rw- 1 student student    0 ноя  6 12:36 f1
drwxrwxr-x 2 tmp6    tmp6    4096 ноя  6 12:39 F1
-rw-rw-rw- 1 student student    0 ноя  6 12:36 f2
-rw-rw-r-- 1 tmp6    tmp6       0 ноя  6 12:39 f3
-rw-rw-r-- 1 tmp6    tmp6       0 ноя  6 12:39 f4

Попытка удалить файл владельца student от пользователя tmp6:
mp6@alexander-VirtualBox:/home/student/58008$ rm f1
rm: невозможно удалить 'f1': Операция не позволена

При этом файл пользователь tmp6 может редактировать и даже перезаписать полностью

От имени владельца папки с установленным Sticky bit можно удалять объекты без дополнительных ограничений:


student@alexander-VirtualBox:~/58008/F$ ls -l
итого 0
-rw-rw-r-- 1 tmp6    tmp6    0 ноя  6 12:43 f1
-rw-rw-r-- 1 tmp6    tmp6    0 ноя  6 12:43 f2
-rw-rw-rw- 1 student student 0 ноя  6 12:43 f3
-rw-rw-rw- 1 student student 0 ноя  6 12:43 f4

student@alexander-VirtualBox:~/58008/F$ rm f1
rm: удалить защищённый от записи пустой обычный файл 'f1'? y
student@alexander-VirtualBox:~/58008/F$ ls 
f2  f3  f4


tudent@alexander-VirtualBox:~/58008$ rm f4
rm: удалить защищённый от записи пустой обычный файл 'f4'? y
student@alexander-VirtualBox:~/58008$ ls -l
итого 12
drwxrwxrwx 2 student student 4096 ноя  6 12:44 F
-rw-rw-rw- 1 student student   36 ноя  6 12:40 f1
drwxrwxr-x 2 tmp6    tmp6    4096 ноя  6 12:39 F1

